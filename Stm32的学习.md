STM32的学习
========  
#### GPIO的各种配置  
#### 串口通讯（UART）的使用，包括蓝牙，WIFI  
#### PWN输入输出  
#### ADC数模转换  
#### 时钟系统
#### 中断系统


#### 寄存器映射
通过绝对地址访问内存单元，外设中利用一个个总线地址来访问。（unsigned int*）的作用是强制类型转化，把一个数值转化成32位地址，前面加一个*变为指针所指的值，把设置代码赋给指针值。  
为了方便起见，可以在开头把（unsigned int*）（xxxxxxxx）给定义（GPIOH_ODR）一下，在之后直接使用。
寄存器映射指的是给特定的内存单元取别名的过程，取的名字叫寄存器。比如，定义后的GPIOH_ODR就是寄存器。像51单片机中的<reg52.h>做的内容主要就是寄存器映射。  
小技巧：多用&，|，！操作，还有按位取反~操作，可以保持原来的属性。例如，GPIOH_ODR$=~(1<<10)  
底层封装过程，利用结构体指针对寄存器进行封装。

#### 固件库创建  
Obj用于存放编译之后生成的hex文件以及其它文件。libraries用于存放stm32固件库的文件。User存放使用者的主文件和启动文件。APP存放外设的驱动文件。  
创建过程：1.新建工程;  2.选择芯片类型（stm32f407ZG）;3.取消手动添加库文件（利用已经建好的模板，否则需要添加）；4.在manage group items里创建四个groups用以存放文件，具体参考固件库模板。并在里面添加个各个文件里的的文件，使它们进入工程。外设（StdPeriph_Driver）只添加了一部分（gpio，syscfg，rcc），其余需要在写程序的时候再次添加。5.在锤子那里选择Microlib，然后选择生成hex（listings）的存放位置，并定义语言和位置（C/C++）。
## IO口的知识  

GPIO_WriteBit    对某一个IO管脚输出高低电平  
GPIO_Write对某一位、端口输出高低电平（比如F位，有八个引脚）  
一般Bit代表某一个管脚，无则代表一个端口。
管教输出速度最大100M。  
首先要定义各种类型的结构体变量。  
初始化结构体是指针型的，所以注意加地址（&GPIO_InitStructure  和C语言结构体类型指针结合起来）  
可以一次对多个管脚进行初始化，前提必须是它们的配置模式需一样。比如： GPIO_InitStructure.GPIO_Pin=GPIO_Pin_9|GPIO_Pin_10; 利用或运算。  
delay_us() 函数中可用于计时器存储的有24位，stm32正常时钟频率是168MHz，八分频之后是21MHz，即每微秒21次。所以delay_us函数最大延时为2的24次方除以21微秒。系统时钟可设定，修改。 查询每一位的值代表的意义很重要。  

添加IO文件时，要在添加相应的C文件之后并在（C/C++）里添加文件位置。
## PWN输入输出
stm32中，pwn输出的本质在于，利用高低电平的占空比的不同，来模拟电平的高低。比如，一个频率为1000MHz中，高电平占了500，则他的电压输入可以看作2.5V（默认电压为5V）。具体而言，占空比的方式，以及定时器都用多种选择。
正余弦波形就是利用不同的占空比，通过循环函数来实现的。  
而芯片中一系列功能的配置，初始化主要是因为芯片的功能比较强大，一个引脚有多个功能，所以要对它进行初始化配置。
#### 时钟系统
时钟主要用来设置分频，分为内部时钟电路（_SI  speed internal）和外部时钟（_SE  speed external）、(内外部时钟电路)。对于现阶段来说，并没有太多用途，主要使用外部时钟源。    

外部时钟需要添加clock.h和clock.c文件（笔者自编），c文件在Project里直接添加即可，h文件注意要在锤子（Options for Target) ）中的(C/C++)里添加头文件路径，不然会找不到。  之后只需在主函数（main.c）里添加include<clock.h>即可。

